<form method="post" action="{% url 'source_edit' workspace.id source.id %}"
      hx-post="{% url 'source_edit' workspace.id source.id %}"
      hx-target="#dialog-body"
      hx-swap="innerHTML">
    {% csrf_token %}
    <sl-input
        label="Name"
        name="name"
        value="{{ form.name.value|default:'' }}"
        required
    ></sl-input>
    {% if form.name.errors %}
        <div class="form-error">{{ form.name.errors }}</div>
    {% endif %}

    <sl-select
        label="Provider Type"
        name="provider_type"
        value="{{ form.provider_type.value|default:'rss' }}"
        class="form-group"
        required
    >
        {% for value, label in form.fields.provider_type.choices %}
        <sl-option value="{{ value }}">{{ label }}</sl-option>
        {% endfor %}
    </sl-select>
    {% if form.provider_type.errors %}
        <div class="form-error">{{ form.provider_type.errors }}</div>
    {% endif %}

    <sl-textarea
        label="Config (JSON)"
        name="config_json"
        rows="4"
        placeholder='{"url": "https://example.com/feed.xml"}'
        class="form-group"
    >{{ form.config_json.value|default:'{}' }}</sl-textarea>
    {% if form.config_json.errors %}
        <div class="form-error">{{ form.config_json.errors }}</div>
    {% endif %}

    <div class="form-actions">
        <sl-button type="submit" variant="primary">Save</sl-button>
        <sl-button type="button" variant="default" onclick="document.getElementById('resource-dialog').hide()">Cancel</sl-button>
    </div>
</form>
<script>
(function() {
  var d = document.getElementById('resource-dialog');
  if (d) { d.label = 'Edit Source'; d.show(); }
})();
</script>
