{% extends "canopyresearch/base.html" %}

{% block title %}{% if source %}Edit{% else %}Create{% endif %} Source - Canopy Research{% endblock %}

{% block content %}
<h2>{% if source %}Edit{% else %}Create{% endif %} Source</h2>

<sl-card>
    <form method="post">
        {% csrf_token %}
        <sl-input
            label="Name"
            name="name"
            value="{{ form.name.value|default:'' }}"
            required
        ></sl-input>
        {% if form.name.errors %}
            <div style="color: red;">{{ form.name.errors }}</div>
        {% endif %}

        <sl-select
            label="Provider Type"
            name="provider_type"
            value="{{ form.provider_type.value|default:'rss' }}"
            style="margin-top: 10px;"
            required
        >
            {% for value, label in form.fields.provider_type.choices %}
            <sl-option value="{{ value }}">{{ label }}</sl-option>
            {% endfor %}
        </sl-select>
        {% if form.provider_type.errors %}
            <div style="color: red;">{{ form.provider_type.errors }}</div>
        {% endif %}

        <sl-textarea
            label="Config (JSON)"
            name="config_json"
            rows="4"
            placeholder='{"url": "https://example.com/feed.xml"}'
            style="margin-top: 10px;"
        >{{ form.config_json.value|default:'{}' }}</sl-textarea>
        {% if form.config_json.errors %}
            <div style="color: red;">{{ form.config_json.errors }}</div>
        {% endif %}

        <sl-select
            label="Status"
            name="status"
            value="{{ form.status.value|default:'healthy' }}"
            style="margin-top: 10px;"
        >
            {% for value, label in form.fields.status.choices %}
            <sl-option value="{{ value }}">{{ label }}</sl-option>
            {% endfor %}
        </sl-select>
        {% if form.status.errors %}
            <div style="color: red;">{{ form.status.errors }}</div>
        {% endif %}

        <sl-button type="submit" variant="primary" style="margin-top: 20px;">Save</sl-button>
        <a href="{% url 'source_list' workspace.id %}">
            <sl-button variant="default">Cancel</sl-button>
        </a>
    </form>
</sl-card>
{% endblock %}
